import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { 
  CheckCircle2, Play, Star, ChevronDown, 
  Flame, Clock, Trophy, Users, ArrowRight,
  ShieldCheck, Smartphone, Dumbbell, Utensils,
  Sparkles, MessageSquare
} from 'lucide-react';

// --- COMPONENTES UI ---

const ButtonCTA = ({ children, className = "", secondary = false, onClick = () => {} }) => (
  <button 
    onClick={onClick}
    className={`
    relative overflow-hidden group w-full md:w-auto px-8 py-5 rounded-full font-black text-lg uppercase tracking-wider transition-all duration-300 transform hover:-translate-y-1 active:translate-y-0
    ${secondary 
      ? 'bg-transparent border-2 border-orange-500 text-orange-500 hover:bg-orange-500 hover:text-white shadow-[0_0_20px_rgba(249,115,22,0.1)]' 
      : 'bg-gradient-to-r from-orange-600 to-red-600 text-white shadow-[0_0_30px_rgba(249,115,22,0.4)] hover:shadow-[0_0_50px_rgba(249,115,22,0.6)]'}
    ${className}
  `}>
    <span className="relative z-10 flex items-center justify-center gap-2">{children}</span>
    {!secondary && <div className="absolute inset-0 bg-gradient-to-r from-red-600 to-orange-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300" />}
  </button>
);

const SectionHeading = ({ title, subtitle, center = true }) => (
  <div className={`mb-16 ${center ? 'text-center' : 'text-left'}`}>
    <h2 className="text-3xl md:text-5xl font-black text-white italic uppercase tracking-tighter mb-4">
      {title} <span className="text-orange-500">.</span>
    </h2>
    {subtitle && <p className="text-neutral-400 text-lg md:text-xl max-w-2xl mx-auto">{subtitle}</p>}
    <div className={`h-1.5 w-24 bg-gradient-to-r from-orange-500 to-red-600 mt-6 rounded-full ${center ? 'mx-auto' : ''}`} />
  </div>
);

// --- SEÇÕES DA PÁGINA ---

const Navbar = () => (
  <nav className="fixed top-0 w-full z-50 bg-black/90 backdrop-blur-md border-b border-white/10 py-4">
    <div className="max-w-7xl mx-auto px-6 flex justify-between items-center">
      <div className="text-2xl font-black text-white italic tracking-tighter">
        QG<span className="text-orange-500">TRAINING</span>
      </div>
      <button className="hidden md:block bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full font-bold text-sm transition-colors">
        Área do Aluno
      </button>
    </div>
  </nav>
);

const Hero = () => (
  <section className="relative min-h-screen pt-24 pb-12 flex items-center overflow-hidden bg-neutral-950">
    {/* Background Image Overlay */}
    <div className="absolute inset-0 z-0">
      <div className="absolute inset-0 bg-gradient-to-r from-neutral-950 via-neutral-950/90 to-transparent z-10" />
      <img 
        src="http://googleusercontent.com/image_generation_content/1" 
        alt="Fitness Woman Abs" 
        className="w-full h-full object-cover opacity-60"
      />
    </div>

    <div className="max-w-7xl mx-auto px-6 relative z-20 grid lg:grid-cols-2 gap-12 items-center">
      <motion.div 
        initial={{ opacity: 0, x: -50 }}
        animate={{ opacity: 1, x: 0 }}
        transition={{ duration: 0.8 }}
      >
        <div className="inline-block bg-orange-500/20 border border-orange-500/30 px-4 py-2 rounded-full mb-6">
          <span className="text-orange-400 font-bold text-sm uppercase tracking-widest flex items-center gap-2">
            <Flame size={16} className="fill-orange-400" /> Método Exclusivo QG
          </span>
        </div>
        <h1 className="text-5xl md:text-7xl font-black text-white italic uppercase tracking-tighter leading-[0.95] mb-6">
          Sua Barriga <br/>
          <span className="text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-500">
            Sequinha
          </span> <br/>
          Em 30 Dias
        </h1>
        <p className="text-xl text-neutral-300 mb-8 max-w-lg leading-relaxed">
          O protocolo de ativação metabólica que já transformou mais de 15.000 mulheres. Sem dietas malucas e treinando apenas 20 minutos por dia.
        </p>
        
        <div className="flex flex-col sm:flex-row gap-4">
          <ButtonCTA>QUERO SECAR AGORA</ButtonCTA>
          <div className="flex items-center gap-2 px-4 py-2 bg-white/5 rounded-lg border border-white/10">
            <div className="flex -space-x-2">
              {[1,2,3].map(i => (
                <div key={i} className="w-8 h-8 rounded-full bg-neutral-800 border-2 border-black overflow-hidden">
                  <img src={`https://i.pravatar.cc/100?img=${i+20}`} alt="User" />
                </div>
              ))}
            </div>
            <div className="text-xs text-neutral-400">
              <span className="text-white font-bold block">4.9/5.0</span>
              de satisfação
            </div>
          </div>
        </div>
      </motion.div>

      {/* VSL Placeholder - Vídeo de Vendas */}
      <motion.div 
        initial={{ opacity: 0, scale: 0.9 }}
        animate={{ opacity: 1, scale: 1 }}
        transition={{ duration: 0.8, delay: 0.2 }}
        className="relative"
      >
        <div className="aspect-video bg-neutral-900 rounded-3xl border border-white/10 shadow-2xl overflow-hidden group relative cursor-pointer">
          <div className="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition-all z-10" />
          <img 
            src="http://googleusercontent.com/image_generation_content/0" 
            alt="Preview Video" 
            className="w-full h-full object-cover opacity-80"
          />
          <div className="absolute inset-0 flex items-center justify-center z-20">
            <div className="w-20 h-20 bg-orange-600 rounded-full flex items-center justify-center shadow-[0_0_40px_rgba(234,88,12,0.6)] group-hover:scale-110 transition-transform">
              <Play size={32} className="fill-white text-white ml-1" />
            </div>
          </div>
        </div>
        <p className="text-center text-neutral-500 text-sm mt-4 font-medium uppercase tracking-widest">
          <span className="text-orange-500 animate-pulse">●</span> Assista ao vídeo explicativo
        </p>
      </motion.div>
    </div>
  </section>
);

const PainPoints = () => (
  <section className="py-24 bg-neutral-900">
    <div className="max-w-6xl mx-auto px-6">
      <SectionHeading 
        title="Cansada de tentar de tudo?" 
        subtitle="Se você se identifica com alguma dessas situações, o QG Training é para você." 
      />
      
      <div className="grid md:grid-cols-3 gap-8">
        {[
          { icon: <Clock size={40} />, title: "Sem tempo para ir à academia", desc: "Rotina corrida que impede treinos longos de 1 hora ou mais." },
          { icon: <Utensils size={40} />, title: "Vive no efeito sanfona", desc: "Emagrece um pouco e ganha tudo de novo (e mais um pouco)." },
          { icon: <Dumbbell size={40} />, title: "Barriga que não sai", desc: "Mesmo fazendo abdominais, a pochete continua lá." }
        ].map((item, idx) => (
          <div key={idx} className="bg-neutral-950 p-8 rounded-3xl border border-white/5 hover:border-orange-500/50 transition-colors group">
            <div className="w-16 h-16 bg-neutral-900 rounded-2xl flex items-center justify-center text-orange-500 mb-6 group-hover:bg-orange-500 group-hover:text-white transition-all">
              {item.icon}
            </div>
            <h3 className="text-xl font-bold text-white mb-4">{item.title}</h3>
            <p className="text-neutral-400 leading-relaxed">{item.desc}</p>
          </div>
        ))}
      </div>
    </div>
  </section>
);

const Method = () => (
  <section className="py-24 bg-black relative overflow-hidden">
    <div className="max-w-7xl mx-auto px-6 relative z-10">
      <div className="grid lg:grid-cols-2 gap-16 items-center">
        <div>
          <SectionHeading 
            center={false}
            title="O Método 3 em 1" 
            subtitle="Nossa metodologia combina três pilares essenciais para desbloquear a queima de gordura natural do seu corpo."
          />
          
          <div className="space-y-8">
            {[
              { title: "Treinos Metabólicos (HIIT)", desc: "Exercícios de alta intensidade que mantêm seu corpo queimando gordura por até 48h após o treino." },
              { title: "Nutrição Flexível", desc: "Aprenda a comer o que gosta nos momentos certos, sem cortar carboidratos ou passar fome." },
              { title: "Mentalidade Blindada", desc: "Técnicas para vencer a ansiedade e a compulsão alimentar que sabotam seus resultados." }
            ].map((pilar, i) => (
              <div key={i} className="flex gap-6">
                <div className="flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br from-orange-500 to-red-600 flex items-center justify-center font-bold text-white text-xl">
                  {i + 1}
                </div>
                <div>
                  <h4 className="text-xl font-bold text-white mb-2">{pilar.title}</h4>
                  <p className="text-neutral-400 leading-relaxed">{pilar.desc}</p>
                </div>
              </div>
            ))}
          </div>
          
          <div className="mt-12">
            <ButtonCTA>QUERO CONHECER O MÉTODO</ButtonCTA>
          </div>
        </div>
        
        <div className="relative">
          <div className="absolute inset-0 bg-gradient-to-tr from-orange-600/20 to-transparent rounded-[3rem] blur-2xl" />
          <img 
            src="http://googleusercontent.com/image_generation_content/3" 
            alt="Treinadora QG" 
            className="relative rounded-[3rem] border-4 border-neutral-800 shadow-2xl w-full object-cover transform rotate-3 hover:rotate-0 transition-transform duration-500"
          />
          
          {/* Floating Card */}
          <div className="absolute bottom-10 -left-10 bg-neutral-900 p-6 rounded-2xl border border-white/10 shadow-xl hidden md:block">
            <div className="flex items-center gap-4">
              <div className="bg-green-500/20 p-3 rounded-full text-green-500">
                <Trophy size={24} />
              </div>
              <div>
                <p className="text-white font-bold text-lg">+15.000</p>
                <p className="text-neutral-500 text-sm">Alunas Transformadas</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
);

const Testimonials = () => (
  <section className="py-24 bg-neutral-900 border-y border-white/5">
    <div className="max-w-7xl mx-auto px-6">
      <SectionHeading 
        title="Resultados Reais" 
        subtitle="Veja o que está acontecendo agora na nossa comunidade exclusiva."
      />
      
      <div className="grid md:grid-cols-3 gap-6">
        {[
          { name: "Juliana M.", loss: "-8kg em 30 dias", text: "Eu achava que não tinha jeito, já tinha tentado todas as dietas. O QG mudou minha vida!" },
          { name: "Patricia S.", loss: "Barriga chapada", text: "Os treinos de 20 min salvaram minha rotina. Consigo fazer antes de ir pro trabalho." },
          { name: "Fernanda L.", loss: "-12cm de cintura", text: "A comunidade motiva demais. Ver os resultados das outras meninas me fez não desistir." }
        ].map((t, i) => (
          <div key={i} className="bg-neutral-950 p-8 rounded-2xl border border-white/5 relative">
            <div className="flex gap-1 text-orange-500 mb-6">
              {[...Array(5)].map((_, s) => <Star key={s} size={16} fill="currentColor" />)}
            </div>
            <p className="text-neutral-300 mb-6 text-lg italic">"{t.text}"</p>
            <div className="flex items-center gap-4 border-t border-white/5 pt-6">
              <div className="w-12 h-12 rounded-full bg-neutral-800 overflow-hidden">
                <img src={`https://i.pravatar.cc/100?img=${i+35}`} alt={t.name} />
              </div>
              <div>
                <p className="text-white font-bold">{t.name}</p>
                <p className="text-orange-500 text-sm font-bold bg-orange-500/10 inline-block px-2 py-0.5 rounded mt-1">{t.loss}</p>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
);

const Offer = () => (
  <section className="py-24 bg-gradient-to-b from-black to-neutral-900 relative overflow-hidden">
    <div className="max-w-5xl mx-auto px-6 relative z-10 text-center">
      <div className="inline-block bg-red-600 text-white font-bold px-4 py-1 rounded-full text-sm uppercase tracking-wider mb-8 animate-pulse">
        Oferta por Tempo Limitado
      </div>
      
      <h2 className="text-4xl md:text-6xl font-black text-white italic uppercase tracking-tighter mb-6">
        Comece Sua Transformação <br/> <span className="text-orange-500">Hoje Mesmo</span>
      </h2>
      
      <div className="bg-neutral-950 border border-orange-500/30 rounded-3xl p-8 md:p-12 max-w-3xl mx-auto shadow-[0_0_60px_rgba(234,88,12,0.15)] relative overflow-hidden">
        {/* Glow */}
        <div className="absolute top-0 right-0 w-64 h-64 bg-orange-500/10 blur-[80px] rounded-full" />

        <div className="flex flex-col md:flex-row justify-between items-center gap-8 mb-12">
          <div className="text-left space-y-4">
            <h3 className="text-xl font-bold text-white">O que você recebe:</h3>
            <ul className="space-y-3">
              {[
                "Acesso completo ao QG Training",
                "Protocolo Barriga Sequinha",
                "Cardápios Nutricionais",
                "Comunidade VIP no WhatsApp",
                "Bônus: Desafio Detox 7 Dias"
              ].map((item, i) => (
                <li key={i} className="flex items-center gap-3 text-neutral-300">
                  <CheckCircle2 size={20} className="text-orange-500 flex-shrink-0" />
                  {item}
                </li>
              ))}
            </ul>
          </div>
          
          <div className="bg-neutral-900 p-6 rounded-2xl border border-white/10 text-center min-w-[240px]">
            <p className="text-neutral-500 line-through text-sm mb-2">De R$ 497,00</p>
            <p className="text-white text-sm mb-1">Por apenas</p>
            <div className="text-5xl font-black text-white tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-500">
              R$ 97
            </div>
            <p className="text-neutral-400 text-xs mt-2">ou 12x de R$ 9,70</p>
          </div>
        </div>
        
        <ButtonCTA className="w-full text-xl py-6">GARANTIR MINHA VAGA AGORA</ButtonCTA>
        
        <div className="flex justify-center items-center gap-6 mt-8 text-neutral-500 text-sm">
          <span className="flex items-center gap-2"><ShieldCheck size={16} /> Compra Segura</span>
          <span className="flex items-center gap-2"><Star size={16} /> Garantia de 7 Dias</span>
        </div>
      </div>
    </div>
  </section>
);

// --- GEMINI AI SECTION ---
const AICoach = () => {
  const [question, setQuestion] = useState('');
  const [answer, setAnswer] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleAsk = async () => {
    if (!question.trim()) return;
    setLoading(true);
    setError('');
    setAnswer('');

    try {
      const apiKey = ""; // Injected by environment
      const systemPrompt = "Você é o 'Coach QG', um assistente virtual especialista no método Barriga Sequinha. Você é motivador, energético e direto. O método foca em: treinos curtos (20min HIIT), nutrição flexível (sem restrições malucas) e mentalidade blindada. Responda à dúvida do usuário com uma dica prática e motivadora em português. Limite a resposta a 3 frases curtas e use emojis.";
      
      const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          contents: [{ parts: [{ text: question }] }],
          systemInstruction: { parts: [{ text: systemPrompt }] }
        })
      });

      if (!response.ok) throw new Error('Falha ao conectar');
      
      const data = await response.json();
      const text = data.candidates?.[0]?.content?.parts?.[0]?.text;
      
      if (text) {
        setAnswer(text);
      } else {
        setError('O Coach está descansando agora. Tente novamente!');
      }
    } catch (err) {
      setError('Erro ao conectar com o Coach. Verifique sua conexão.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <section className="py-24 bg-neutral-900 relative overflow-hidden border-t border-white/5">
      <div className="max-w-4xl mx-auto px-6 relative z-10">
        <div className="text-center mb-10">
          <div className="inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full text-white font-bold text-sm uppercase tracking-wider mb-6 animate-pulse shadow-lg">
            <Sparkles size={16} /> Nova Funcionalidade IA
          </div>
          <h2 className="text-3xl md:text-5xl font-black text-white italic uppercase tracking-tighter mb-4">
            Coach Virtual <span className="text-indigo-500">QG</span>
          </h2>
          <p className="text-neutral-400 text-lg">
            Tire suas dúvidas sobre o método, nutrição ou treino agora mesmo com nossa Inteligência Artificial.
          </p>
        </div>

        <div className="bg-neutral-950 border border-indigo-500/30 rounded-3xl p-6 md:p-8 shadow-2xl relative">
          {/* Decorative elements */}
          <div className="absolute -top-10 -right-10 w-40 h-40 bg-indigo-600/20 blur-[50px] rounded-full" />
          
          <div className="space-y-4 relative z-10">
            <div>
              <label className="block text-white font-bold mb-2 ml-2 text-sm">Sua Pergunta:</label>
              <div className="relative">
                <textarea
                  value={question}
                  onChange={(e) => setQuestion(e.target.value)}
                  placeholder="Ex: O que comer antes do treino? Posso treinar descalça? Como perder a pochete?"
                  className="w-full bg-neutral-900 border border-white/10 rounded-2xl p-4 text-white placeholder:text-neutral-600 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 resize-none h-24 transition-all"
                />
                <div className="absolute bottom-3 right-3">
                    <MessageSquare size={18} className="text-neutral-600" />
                </div>
              </div>
            </div>

            <button 
              onClick={handleAsk}
              disabled={loading || !question.trim()}
              className="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-neutral-800 disabled:text-neutral-500 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-indigo-500/20 flex items-center justify-center gap-2"
            >
              {loading ? (
                <>
                  <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
                  Consultando o Coach...
                </>
              ) : (
                <>
                  <Sparkles size={18} /> PERGUNTAR AO COACH
                </>
              )}
            </button>

            <AnimatePresence>
              {(answer || error) && (
                <motion.div
                  initial={{ opacity: 0, y: 10 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -10 }}
                  className={`p-6 rounded-2xl mt-6 border ${error ? 'bg-red-500/10 border-red-500/30' : 'bg-indigo-500/10 border-indigo-500/30'}`}
                >
                  <div className="flex gap-4">
                    <div className={`w-10 h-10 rounded-full flex items-center justify-center shrink-0 ${error ? 'bg-red-500/20 text-red-400' : 'bg-indigo-500/20 text-indigo-400'}`}>
                      {error ? <MessageSquare size={20} /> : <Sparkles size={20} />}
                    </div>
                    <div>
                      <p className={`font-bold text-sm mb-1 ${error ? 'text-red-400' : 'text-indigo-400'}`}>
                        {error ? 'Erro' : 'Coach QG diz:'}
                      </p>
                      <p className="text-white leading-relaxed">
                        {error || answer}
                      </p>
                    </div>
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      </div>
    </section>
  );
};

const FAQ = () => {
  const [openIndex, setOpenIndex] = useState(0);
  const faqs = [
    { q: "Preciso de equipamentos para treinar?", a: "Não! 100% dos exercícios do QG Training usam apenas o peso do seu corpo. Você pode fazer na sala de casa, viajando ou no parque." },
    { q: "Tenho pouco tempo, vai funcionar?", a: "Sim, o método foi criado justamente para mulheres ocupadas. Nossos treinos duram em média 20 minutos e queimam mais gordura que 1 hora de caminhada." },
    { q: "E se eu não gostar?", a: "Você tem 7 dias de garantia incondicional. Se achar que não é para você, devolvemos 100% do seu dinheiro sem perguntas." },
    { q: "Serve para iniciantes?", a: "Com certeza. Temos variações de baixa intensidade para todos os exercícios, permitindo que você evolua no seu próprio ritmo." },
  ];

  return (
    <section className="py-24 bg-neutral-950">
      <div className="max-w-3xl mx-auto px-6">
        <SectionHeading title="Dúvidas Frequentes" />
        <div className="space-y-4">
          {faqs.map((item, idx) => (
            <div key={idx} className="border border-white/10 rounded-2xl bg-black overflow-hidden">
              <button 
                onClick={() => setOpenIndex(openIndex === idx ? -1 : idx)}
                className="w-full flex items-center justify-between p-6 text-left text-white font-bold hover:bg-neutral-900 transition-colors"
              >
                {item.q}
                <ChevronDown className={`transition-transform duration-300 ${openIndex === idx ? 'rotate-180 text-orange-500' : 'text-neutral-500'}`} />
              </button>
              <AnimatePresence>
                {openIndex === idx && (
                  <motion.div 
                    initial={{ height: 0 }} 
                    animate={{ height: "auto" }} 
                    exit={{ height: 0 }} 
                    className="overflow-hidden"
                  >
                    <p className="px-6 pb-6 pt-0 text-neutral-400 leading-relaxed border-t border-white/5 mt-2">
                      {item.a}
                    </p>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};

const Footer = () => (
  <footer className="bg-black py-12 border-t border-white/10">
    <div className="max-w-7xl mx-auto px-6 text-center">
      <div className="text-2xl font-black text-white italic tracking-tighter mb-6">
        QG<span className="text-orange-500">TRAINING</span>
      </div>
      <div className="flex justify-center gap-6 mb-8 text-neutral-400">
        <a href="#" className="hover:text-white">Instagram</a>
        <a href="#" className="hover:text-white">Facebook</a>
        <a href="#" className="hover:text-white">Youtube</a>
      </div>
      <p className="text-neutral-600 text-sm">
        © 2025 QG Training. Todos os direitos reservados. <br/>
        Este site não faz parte do site do Facebook ou Facebook Inc.
      </p>
    </div>
  </footer>
);

export default function LandingPage() {
  return (
    <main className="bg-black min-h-screen text-neutral-200 font-sans selection:bg-orange-500/30 selection:text-white">
      <Navbar />
      <Hero />
      <PainPoints />
      <Method />
      <Testimonials />
      <Offer />
      <AICoach />
      <FAQ />
      <Footer />
    </main>
  );
}
